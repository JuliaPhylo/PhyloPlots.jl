<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>better edges · PhyloPlots.jl</title><meta name="title" content="better edges · PhyloPlots.jl"/><meta property="og:title" content="better edges · PhyloPlots.jl"/><meta property="twitter:title" content="better edges · PhyloPlots.jl"/><meta name="description" content="Documentation for PhyloPlots.jl."/><meta property="og:description" content="Documentation for PhyloPlots.jl."/><meta property="twitter:description" content="Documentation for PhyloPlots.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="PhyloPlots.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PhyloPlots.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">home</a></li><li><span class="tocitem">manual</span><ul><li><a class="tocitem" href="../installation/">installation</a></li><li><a class="tocitem" href="../getting_started/">getting started</a></li><li><a class="tocitem" href="../untangling_edges/">untangling edges</a></li><li class="is-active"><a class="tocitem" href>better edges</a><ul class="internal"><li><a class="tocitem" href="#Different-hybrid-edge-styles"><span>Different hybrid edge styles</span></a></li><li><a class="tocitem" href="#Using-edge-lengths"><span>Using edge lengths</span></a></li><li><a class="tocitem" href="#Varying-edge-widths"><span>Varying edge widths</span></a></li><li><a class="tocitem" href="#Customization"><span>Customization</span></a></li></ul></li><li><a class="tocitem" href="../adding_data/">adding data</a></li></ul></li><li><span class="tocitem">library</span><ul><li><a class="tocitem" href="../../lib/public/">public</a></li><li><a class="tocitem" href="../../lib/internals/">internals</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">manual</a></li><li class="is-active"><a href>better edges</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>better edges</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaPhylo/PhyloPlots.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaPhylo/PhyloPlots.jl/blob/master/docs/src/man/better_edges.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Better-edges"><a class="docs-heading-anchor" href="#Better-edges">Better edges</a><a id="Better-edges-1"></a><a class="docs-heading-anchor-permalink" href="#Better-edges" title="Permalink"></a></h1><h2 id="Different-hybrid-edge-styles"><a class="docs-heading-anchor" href="#Different-hybrid-edge-styles">Different hybrid edge styles</a><a id="Different-hybrid-edge-styles-1"></a><a class="docs-heading-anchor-permalink" href="#Different-hybrid-edge-styles" title="Permalink"></a></h2><p>We can use the <code>style</code> option to visualize minor hybrid edges as simple lines, unlike the <a href="https://icytree.org/">icytree</a> style visualization. <code>style</code> is by default <code>:fulltree</code>, but by switching it to <code>:majortree</code>, we can draw minor hybrid edges as diagonal lines.</p><pre><code class="language-julia hljs">plot(net, style=:majortree);</code></pre><p><img src="../../assets/figures/style_example.svg" alt="example1"/></p><h2 id="Using-edge-lengths"><a class="docs-heading-anchor" href="#Using-edge-lengths">Using edge lengths</a><a id="Using-edge-lengths-1"></a><a class="docs-heading-anchor-permalink" href="#Using-edge-lengths" title="Permalink"></a></h2><p>We can use <code>useedgelength=true</code> to draw a plot that uses the network&#39;s edge lengths to determine the lengths of the lines. For this, we&#39;ll use a network that has branch lengths:</p><pre><code class="language-julia hljs">net = readnewick(&quot;(A:3.3,((B:1.5,#H1:0.5):1.5,((C:1)#H1:1.8,D:1.1):.2):0.3);&quot;)</code></pre><p><img src="../../assets/figures/edge_len_example.svg" alt="example2"/></p><div class="admonition is-info" id="Note-e3a54ba4dcf304d6"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-e3a54ba4dcf304d6" title="Permalink"></a></header><div class="admonition-body"><p>I used a DataFrame (not shown) to add the label &quot;N&quot; to the plot. For more on this, see the <a href="../adding_data/#Adding-labels">Adding labels</a> section.</p></div></div><p>If branch lengths represent time, D could represent a fossil, or a virus strain sequenced a year before the others. Seeing this visually is the advantage of <code>useedgelength=true</code>.</p><p>This network happens to be time consistent, because the distance along the time (x) axis from node <code>N</code> to the hybrid node <code>H1</code> is the same both ways.</p><div class="admonition is-info" id="Time-consistency-49f18657db2a7544"><header class="admonition-header">Time consistency<a class="admonition-anchor" href="#Time-consistency-49f18657db2a7544" title="Permalink"></a></header><div class="admonition-body"><p>A network is time-consistent if all the paths between 2 given nodes all have the same length. Time inconsistency can occur when branch lengths are not measured in calendar time, such as if branch lengths are in substitutions per site (some paths might evolve with more substitutions than others), or in number of generations (some lineages might have 1 generation per year, others more or fewer generations per year), or in coalescent units (number of generations / effective population size).</p><p>A time-consistent network may be ultrametric (the distance between the root and the tips is the same across all tips), or not like the network above.</p></div></div><p>Time-inconsistent networks like these ones below might cause confusion:</p><pre><code class="language-julia hljs">net1 = readnewick(&quot;(A:3.3,((B:1.5,#H1:1.2):1.5,((C:1.8)#H1:1,D:1.1):.2):0.3);&quot;);
net2 = readnewick(&quot;(A:3.3,((B:1.5,#H1:0.2):1.5,((C:1)#H1:1.8,D:1.1):.2):0.3);&quot;);</code></pre><p><img src="../../assets/figures/edge_len_example2.svg" alt="example3"/></p><p>It may be useful to consider using <code>style=:majortree</code> if it causes too much confusion, since the <code>:majortree</code> style doesn&#39;t visually represent minor edge lengths. Because of this, I used the <code>showedgelength=true</code> option to see the information anyway.</p><pre><code class="language-julia hljs">R&quot;layout&quot;([1 2])
plot(net1, useedgelength=true, style = :majortree, showedgelength=true, arrowlen=0.1);
plot(net2, useedgelength=true, style = :majortree, showedgelength=true, arrowlen=0.1);</code></pre><p><img src="../../assets/figures/edge_len_example3.svg" alt="example4"/></p><p>I also used the <code>arrowlen=0.1</code> option to show the arrow tips to show the direction of minor edges, which are hidden by default when using the <code>style=:majortree</code> option.</p><h2 id="Varying-edge-widths"><a class="docs-heading-anchor" href="#Varying-edge-widths">Varying edge widths</a><a id="Varying-edge-widths-1"></a><a class="docs-heading-anchor-permalink" href="#Varying-edge-widths" title="Permalink"></a></h2><p>We can vary edge widths to show population sizes for example. First we need to map each edge number to the desired width for that edge. We do this with a dictionary.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using RCall # to send any command to R, to modify the plot</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; R&quot;par&quot;(mar=[.1,.1,.1,.1]); R&quot;layout&quot;([1 2]);</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; plot(net1, showedgenumber=true);</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; R&quot;mtext&quot;(&quot;edge numbers, used\nas keys in edgewidth&quot;, side=1, line=-1);
       # below: population sizes on the log scale</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; log_populationsize = Dict(e.number =&gt; log10(1_000) for e in net1.edge);</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; log_populationsize[9] = log10(100_000); # larger populations on edge 9</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; log_populationsize[1] = log10(100_000); #                and on edge 1</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; log_populationsize</code><code class="nohighlight hljs ansi" style="display:block;">Dict{Int64, Float64} with 9 entries:
  5 =&gt; 3.0
  4 =&gt; 3.0
  6 =&gt; 3.0
  7 =&gt; 3.0
  2 =&gt; 3.0
  9 =&gt; 5.0
  8 =&gt; 3.0
  3 =&gt; 3.0
  1 =&gt; 5.0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; plot(net1, edgewidth=log_populationsize);</code></pre><p><img src="../../assets/figures/edge_len_example5.svg" alt="example5"/></p><h2 id="Customization"><a class="docs-heading-anchor" href="#Customization">Customization</a><a id="Customization-1"></a><a class="docs-heading-anchor-permalink" href="#Customization" title="Permalink"></a></h2><p>Check out the list of <a href="../../lib/public/#PhyloPlots.plot-Tuple{HybridNetwork}"><code>plot</code></a> options.</p><p>In the example below, we first highlight in orange the edges on the 2 paths from the root to C. Then we change the type of the minor edge (to hide it).</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; ecols = Dict(i =&gt; &quot;black&quot; for i in 1:9); # make all black</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; for i in [9,8,6,5, 4,3] # except for edges ancestral to C
         ecols[i] = &quot;orangered&quot;
       end</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ecols</code><code class="nohighlight hljs ansi" style="display:block;">Dict{Int64, String} with 9 entries:
  5 =&gt; &quot;orangered&quot;
  4 =&gt; &quot;orangered&quot;
  6 =&gt; &quot;orangered&quot;
  7 =&gt; &quot;black&quot;
  2 =&gt; &quot;black&quot;
  9 =&gt; &quot;orangered&quot;
  8 =&gt; &quot;orangered&quot;
  3 =&gt; &quot;orangered&quot;
  1 =&gt; &quot;black&quot;</code></pre><pre><code class="language-julia hljs">plot(net1, edgecolor=ecols, defaultedgecolor=&quot;grey80&quot;, minorlinetype=&quot;solid&quot;);
plot(net1, style=:majortree, majorhybridedgecolor=&quot;red&quot;,
     minorlinetype=&quot;blank&quot;); # make minor edges (arrows) of type &#39;blank&#39;</code></pre><p><img src="../../assets/figures/edge_len_example6.svg" alt="example6"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../untangling_edges/">« untangling edges</a><a class="docs-footer-nextpage" href="../adding_data/">adding data »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 12 August 2025 13:08">Tuesday 12 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
