<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>internals · PhyloPlots.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="../../"><img class="logo" src="../../assets/logo.png" alt="PhyloPlots.jl logo"/></a><h1>PhyloPlots.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../">home</a></li><li><span class="toctext">library</span><ul><li><a class="toctext" href="../public/">public</a></li><li class="current"><a class="toctext" href>internals</a><ul class="internal"><li><a class="toctext" href="#index-1">index</a></li><li><a class="toctext" href="#functions-1">functions</a></li></ul></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>library</li><li><a href>internals</a></li></ul><a class="edit-page" href="https://github.com/cecileane/PhyloPlots.jl/blob/master/docs/src/lib/internals.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>internals</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="internal-documentation-1" href="#internal-documentation-1">internal documentation</a></h1><p>Documentation for <code>PhyloPlots</code>&#39;s internal functions. Those functions are not exported, but can still be used (like: <code>PhyloPlots.foo()</code> for a function named <code>foo()</code>).</p><p>&lt;!–<code>@contents Pages = [&quot;internals.md&quot;]</code>–&gt;</p><h2><a class="nav-anchor" id="index-1" href="#index-1">index</a></h2><ul><li><a href="#PhyloPlots.checkNodeDataFrame-Tuple{PhyloNetworks.HybridNetwork,DataFrames.DataFrame}"><code>PhyloPlots.checkNodeDataFrame</code></a></li><li><a href="#PhyloPlots.getEdgeNodeCoordinates-Tuple{PhyloNetworks.HybridNetwork,Bool}"><code>PhyloPlots.getEdgeNodeCoordinates</code></a></li><li><a href="#PhyloPlots.prepareEdgeDataFrame-Tuple{PhyloNetworks.HybridNetwork,DataFrames.DataFrame,Bool,Array{Float64,1},Array{Float64,1},Array{Float64,1},Array{Float64,1}}"><code>PhyloPlots.prepareEdgeDataFrame</code></a></li><li><a href="#PhyloPlots.prepareNodeDataFrame-Tuple{PhyloNetworks.HybridNetwork,DataFrames.DataFrame,Bool,Bool,Bool,Array{Float64,1},Array{Float64,1}}"><code>PhyloPlots.prepareNodeDataFrame</code></a></li><li><a href="#PhyloPlots.rexport-Tuple{PhyloNetworks.HybridNetwork}"><code>PhyloPlots.rexport</code></a></li></ul><p>&lt;!– ## Types –&gt;</p><h2><a class="nav-anchor" id="functions-1" href="#functions-1">functions</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PhyloPlots.checkNodeDataFrame-Tuple{PhyloNetworks.HybridNetwork,DataFrames.DataFrame}" href="#PhyloPlots.checkNodeDataFrame-Tuple{PhyloNetworks.HybridNetwork,DataFrames.DataFrame}"><code>PhyloPlots.checkNodeDataFrame</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">checkNodeDataFrame(net, nodeLabel)</code></pre><p>Check data frame for node annotations:</p><ul><li>check that the data has at least 2 columns (if it has any)</li><li>check that the first column has integers (to serve as node numbers)</li><li>remove rows with no node numbers</li><li>warning if some node numbers in the data are not in the network.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/cecileane/PhyloPlots.jl/blob/80c0ce642d48357d6a37eb21ebc98641f59fab1a/src/phylonetworksPlots.jl#L164-L172">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PhyloPlots.getEdgeNodeCoordinates-Tuple{PhyloNetworks.HybridNetwork,Bool}" href="#PhyloPlots.getEdgeNodeCoordinates-Tuple{PhyloNetworks.HybridNetwork,Bool}"><code>PhyloPlots.getEdgeNodeCoordinates</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">getEdgeNodeCoordinates(net, useEdgeLength)</code></pre><p>Calculate coordinates for plotting later with Gadfly or RCall.</p><p>Actually modifies some (minor) attributes of the network, as it calls <code>directEdges!</code>, <code>preorder!</code> and <code>cladewiseorder!</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/cecileane/PhyloPlots.jl/blob/80c0ce642d48357d6a37eb21ebc98641f59fab1a/src/phylonetworksPlots.jl#L4-L11">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PhyloPlots.prepareEdgeDataFrame-Tuple{PhyloNetworks.HybridNetwork,DataFrames.DataFrame,Bool,Array{Float64,1},Array{Float64,1},Array{Float64,1},Array{Float64,1}}" href="#PhyloPlots.prepareEdgeDataFrame-Tuple{PhyloNetworks.HybridNetwork,DataFrames.DataFrame,Bool,Array{Float64,1},Array{Float64,1},Array{Float64,1},Array{Float64,1}}"><code>PhyloPlots.prepareEdgeDataFrame</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">prepareEdgeDataFrame(net, edgeLabel::DataFrame, mainTree::Bool,
    edge_xB, edge_xE, edge_yB, edge_yE)</code></pre><p>Check data frame for edge annotation. <code>edge_*</code>: Float64 vectors giving the coordinates for the beginning and end of edges. Return data frame with columns</p><ul><li>x, y: coordinates on the plots</li><li>len: node name</li><li>gam: gamma (inheritance value)</li><li>num: node number</li><li>lab: node label</li><li>hyb: is hybrid?</li><li>min: is minor?</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/cecileane/PhyloPlots.jl/blob/80c0ce642d48357d6a37eb21ebc98641f59fab1a/src/phylonetworksPlots.jl#L236-L250">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PhyloPlots.prepareNodeDataFrame-Tuple{PhyloNetworks.HybridNetwork,DataFrames.DataFrame,Bool,Bool,Bool,Array{Float64,1},Array{Float64,1}}" href="#PhyloPlots.prepareNodeDataFrame-Tuple{PhyloNetworks.HybridNetwork,DataFrames.DataFrame,Bool,Bool,Bool,Array{Float64,1},Array{Float64,1}}"><code>PhyloPlots.prepareNodeDataFrame</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">prepareNodeDataFrame(net, nodeLabel::DataFrame,
    showNodeNumber::Bool, showIntNodeLabel::Bool, labelnodes::Bool,
    node_x, node_y)</code></pre><p>Make data frame for node annotation. <code>node_*</code> should be Float64 vectors. <code>nodeLabel</code> should have columns as required by <a href="#PhyloPlots.checkNodeDataFrame-Tuple{PhyloNetworks.HybridNetwork,DataFrames.DataFrame}"><code>checkNodeDataFrame</code></a></p><p>Columns of output data frame:</p><ul><li>x, y: coordinates on the plots (from <code>node_*</code>)</li><li>name: node name</li><li>num: node number</li><li>lab: node label</li><li>lea: is leaf?</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/cecileane/PhyloPlots.jl/blob/80c0ce642d48357d6a37eb21ebc98641f59fab1a/src/phylonetworksPlots.jl#L194-L208">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PhyloPlots.rexport-Tuple{PhyloNetworks.HybridNetwork}" href="#PhyloPlots.rexport-Tuple{PhyloNetworks.HybridNetwork}"><code>PhyloPlots.rexport</code></a> — <span class="docstring-category">Method</span>.</div><div><pre><code class="language-julia">rexport(net::HybridNetwork; mainTree=false, useEdgeLength=true)</code></pre><p>Create an RObject of class <code>phylo</code> (and <code>evonet</code> depending on the number of hybridizations) recognized by the <code>ape</code> library in R (S3 object). This RObject can be evaluated using the tools available in the <code>ape</code> library in R. For example, we can visualize the network using <code>ape</code>&#39;s <code>plot</code> function.</p><p>not exported: <a href="../public/#RCall.sexp-Tuple{PhyloNetworks.HybridNetwork}"><code>sexp</code></a> is the best way to go.</p><p><strong>Arguments</strong></p><ul><li>useEdgeLength: if true, export edge lengths from <code>net</code>.</li><li>mainTree: if true, minor hybrid edges are omitted.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; net = readTopology(&quot;(((A,(B)#H1:::0.9),(C,#H1:::0.1)),D);&quot;);
julia&gt; phy = rexport(net)
RCall.RObject{RCall.VecSxp}
$Nnode
[1] 5

$edge
     [,1] [,2]
[1,]    5    6
[2,]    5    4
[3,]    6    8
[4,]    6    7
[5,]    7    3
[6,]    8    1
[7,]    8    9
[8,]    9    2

$tip.label
[1] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot;

$reticulation
     [,1] [,2]
[1,]    7    9

$reticulation.gamma
[1] 0.1

attr(,&quot;class&quot;)
[1] &quot;evonet&quot; &quot;phylo&quot;

julia&gt; using RCall

julia&gt; R&quot;library(ape)&quot;;

julia&gt; phy
RCall.RObject{RCall.VecSxp}

    Evolutionary network with 1 reticulation

               --- Base tree ---
Phylogenetic tree with 4 tips and 5 internal nodes.

Tip labels:
[1] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot;

Rooted; no branch lengths.

R&gt; phy

Evolutionary network with 1 reticulation

               --- Base tree ---
Phylogenetic tree with 4 tips and 5 internal nodes.

Tip labels:
[1] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot;

Rooted; no branch lengths.

R&gt; str(phy)
List of 5
$ Nnode             : int 5
$ edge              : int [1:8, 1:2] 5 5 6 6 7 8 8 9 6 4 ...
$ tip.label         : chr [1:4] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot;
$ reticulation      : int [1, 1:2] 7 9
$ reticulation.gamma: num 0.1
- attr(*, &quot;class&quot;)= chr [1:2] &quot;evonet&quot; &quot;phylo&quot;</code></pre></div><a class="source-link" target="_blank" href="https://github.com/cecileane/PhyloPlots.jl/blob/80c0ce642d48357d6a37eb21ebc98641f59fab1a/src/rexport.jl#L100">source</a></section><footer><hr/><a class="previous" href="../public/"><span class="direction">Previous</span><span class="title">public</span></a></footer></article></body></html>
